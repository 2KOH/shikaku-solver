# shikaku-solver

## 概要
[四角に切れ](https://www.nikoli.co.jp/ja/puzzles/shikaku/)の解を探索する JavaScript のプログラムです。ES2015 以降の文法を使っているので、古いブラウザでは動作しません。

## 使い方

### Node.js
```
const Solver = require('shikaku-solver');

console.log([...Solver.solve({
	rows: 2,
	columns: 3,
	numbers: [
		{ x: 0, y: 0, number: 2 },
		{ x: 2, y: 1, number: 4 },
	]
})]);
```

### ブラウザ
```
// shikaku-solver.js を読み込んでおく。

console.log([...ShikakuSolver.solve({
	rows: 2,
	columns: 3,
	numbers: [
		{ x: 0, y: 0, number: 2 },
		{ x: 2, y: 1, number: 4 },
	]
})]);
```

## デモ
https://2koh.github.io/shikaku-solver/

## アルゴリズムのメモ
いわゆる手筋は未実装。

探索順は、深さ優先探索。
左上のマスから順に、可能な四角形を当てはめていき、全マス埋まったら完成、という方法。

### あるマスが左上のマスとなる四角形を探す方法
高さ1 の四角形、高さ2 の四角形、の順に可能な四角形を探していく。

高さn の四角形が可能かをチェックする方法は、
1. あるマスから n行目までのマスのうち、数字マスもしくは確定マスを、左から順に二つ探す（見つかった順に、A, B とする）。
1. A が確定マスであれば、四角形不可能。
1. A と B が同じ列にあるなら、四角形不可能。
1. A の数字が n で割り切れないなら、四角形不可能。
1. A の数字を n で割った値が、A の列から B の列の手前までの間であれば四角形可能。
1. そうでなければ四角形不可能。

また、盤面外にはみ出すか、A があるマスと同じ列の確定マスであれば、それ以上の高さの四角形は不可能であり、探索を終了する。

上記の A と B は、高さn の四角形が可能かをチェックする際に、高さn-1 の四角形が可能かをチェックした際の値を利用することで、高速化を図れる。

## データ構造のメモ
盤面のマスを二次元配列ではなく一次元配列で保持している。
さらに、各行の末尾と各列の末尾に確定マスをダミーとして挿入している。
これにより、四角形が盤面外にはみ出ているかの判定を行うのではなく、四角形が確定マスと重なっているかの判定を行えばよいようになっている。

## ライセンス
MIT
